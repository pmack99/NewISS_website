<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>The International Space Station Tracker</title>
  <meta name="description" content="Free Bootstrap Theme by BootstrapMade.com">
  <meta name="keywords" content="free website templates, free bootstrap themes, free template, free bootstrap, free website template">

  <link href="https://fonts.googleapis.com/css?family=Josefin+Sans|Open+Sans|Raleway" rel="stylesheet">
  <link rel="stylesheet" href="css/flexslider.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link rel="stylesheet" href="css/style.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <!-- leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin="" />
  <!-- leaflet scriptfiles -->
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
    crossorigin=""></script>
  <!--Link the javascript files this is for the moment time thingy-->
  <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>

</head>

<body id="top" data-spy="scroll">
  <!--top header-->

  <header id="home">

    <section class="top-nav hidden-xs">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <div class="top-left">
<!-- 
              <ul>
                <li><a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
                <li><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
                <li><a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
                <li><a href="#"><i class="fa fa-vk" aria-hidden="true"></i></a></li>
                <li><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
              </ul> -->

            </div>
          </div>

          <div class="col-md-6">
            <div class="top-right">
              <p>ISS Location:<span>Somewhere 400 KM above the Earth!</span></p>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!--main-nav-->

    <div id="main-nav">

      <nav class="navbar">
        <div class="container">

          <div class="navbar-header">
            <!-- <a href="index.html" class="navbar-brand">ISS Tracker</a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#ftheme"> -->
              <span class="sr-only">Toggle</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
          </div>

          <div class="navbar-collapse collapse" id="ftheme">

            <ul class="nav navbar-nav navbar-right">
              <li><a href="#home">Home</a></li>
              <li><a href="#map">Map</a></li>
              <li><a href="#issPass">Pass</a></li>
              <li><a href="#apod">Photos</a></li>
              <li><a href="#contact">Contact</a></li>
              <!-- <li class="hidden-sm hidden-xs">
                <a href="#" id="ss"><i class="fa fa-search" aria-hidden="true"></i></a> -->
              </li>
            </ul>

          </div>

          <div class="search-form">
            <form>
              <input type="text" id="s" size="40" placeholder="Search..." />
            </form>
          </div>

        </div>
      </nav>
    </div>

  </header>

  <!--slider-->
  <div id="slider" class="flexslider">

    <ul class="slides">
      <li>
        <img src="images/slider/1.jpg">

        <div class="caption">
          <h2><span>The International Space Station</span></h2>
          <!-- <h2><span>html theme</span></h2> -->
          <p>Launched in 1998, this station has been the home to over 200 astronauts from 16 different countries</p>
          <!-- <button class="btn">Read More</button> -->
        </div>

      </li>
      <li>
        <img src="images/slider/2.jpg">

        <div class="caption">
          <h2><span>The ISS travels at 27,000 KM/h</span></h2>
          <!-- <h2><span>html theme</span></h2> -->
          <p>The ISS orbits the Earth an incredible 16 times per day at an altitude of 400 KM</p>
          <!-- <button class="btn">Read More</button> -->
        </div>

      </li>
      <li>
        <img src="images/slider/3.jpg">

        <div class="caption">
          <h2><span>ISS is the largest manned object ever put into space</span></h2>
          <!-- <h2><span>html theme</span></h2> -->
          <p>The ISS has a pressurized volume of 32,333 cubic feet. It's four times larger
            than the Russian space station MIR and five times larger than the U.S. station Skylab. </p>
          <!-- <button class="btn">Read More</button> -->
        </div>

      </li>
    </ul>

  </div>

  <!--map-->
  <div class="container" id="map">

    <h2>Where is the ISS?</h2>
    <p>A realtime look at the location of the ISS</p>
    <div class="row" id="mapBox">
      <div class="col-9" id="mapId"></div>
      <div class="col-3" id="issInfo">
        <br>
        <div id="latitudeN"> </div>
        <div id="longitudeN"> </div>
        <hr>
        <div id="altitude"> </div>
        <div id="velocity"> </div>
        <hr>
        <div id="solar_latN"></div>
        <div id="solar_lonN"></div>
        <hr>
        <div id="visibility"> </div>
      </div>

    </div>

  </div>


  <!--ISS Pass-->
  <div class="container">
    <div class="row issPass" id= "issPass">
      <br>
      <h3>ISS Pass Data</h3>
      <div class="input-group mb-3">
        <div class="input-group-prepend ">
          <button class="button btn-warning" type="button" id="button-addon1">Enter City</button>
        </div>
        <input type="text" class="form-control col-md-3 " placeholder="Example - Orlando, FL">
      </div>
      <div class="scrollit">
        <table class="table">
          <div id="tableScroll">
            <thead>
              <tr>
                <th scope="col">City</th>
                <th scope="col">ISS Pass</th>
                <th scope="col">Duration</th>
                <th scope="col">Appears</th>
                <th scope="col">Start Elevation</th>
                <th scope="col">Max Elevation</th>
                <th scope="col">Departs</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td></td>

              </tr>
            </tbody>
          </div>
        </table>
      </div>
    </div>
  </div>

  <!--photo container-->
  <div class="container">
    <div class="row apod" id= "apod">
        <div class="col-12" id="apodText">
            <h3>Images of the ISS</h3>
        </div>
        <div class="row">
            <div class="col-12" id="apod1"> </div>

        </div>
        <div class="row">
            <div class="col-12" id="apod2"> </div>
            <div class="pCaption text"></div>
        </div>


    </div>
</div>

</div>




  <!--footer-->
  <div id="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-4" id= "contact">
          <div class="footer-heading">
            <h3><span>about</span> us</h3>
            <p>To explore strange new worlds to seek out new life and new civilizations to boldly go where no man has
              gone before. It's time to play the music.</p>
            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="footer-heading">
            <h3><span>latest</span> news</h3>
            <ul>
              <li><a href="#">Trends don't matter, but techniques do</a></li>
              <li><a href="#">Trends don't matter, but techniques do</a></li>
              <li><a href="#">Trends don't matter, but techniques do</a></li>
              <li><a href="#">Trends don't matter, but techniques do</a></li>
            </ul>
          </div>
        </div>

        <div class="col-md-4">
          <div class="footer-heading">
            <h3><span>follow</span> us on instagram</h3>
            <div class="insta">
              <ul>
                <img src="images/footer/footer1.jpg" alt="">
                <img src="images/footer/footer2.jpg" alt="">
                <img src="images/footer/footer3.jpg" alt="">
                <img src="images/footer/footer4.jpg" alt="">
                <img src="images/footer/footer5.jpg" alt="">
                <img src="images/footer/footer6.jpg" alt="">
              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!--bottom footer-->
  <div id="bottom-footer" class="hidden-xs">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <div class="footer-left">
            &copy; MyBix Theme. All rights reserved

          </div>
        </div>

        <div class="col-md-8">
          <div class="footer-right">
            <ul class="list-unstyled list-inline pull-right">
              <li><a href="#home">Home</a></li>
              <li><a href="#map">Map</a></li>
              <li><a href="#issPass">Pass</a></li>
              <li><a href="#apod">Photos</a></li>
              <li><a href="#contact">Contact</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>


  <script type="text/javascript">


    var latitude = "";
    var longitude = "";
    var altitude = "";
    var velocity = "";
    var solar_lat = "";
    var solar_lon = "";
    var mymap = null;


    function moveIss() {
      if (mymap !== null) mymap.remove();

      var queryURL = "https://api.wheretheiss.at/v1/satellites/25544";

      $.ajax({
        url: queryURL,
        method: "GET"
      })
        .then(function (response) {
          console.log(response);

          console.log(response.latitude);
          console.log(response.longitude);

          var altitude = response.altitude;
          var velocity = response.velocity;
          var visibility = response.visibility;
          var latitude = response.latitude;
          var longitude = response.longitude;
          var solar_lat = response.solar_lat;
          var solar_lon = response.solar_lon;

          var altitudeN = altitude.toFixed(2);
          var velocityN = velocity.toFixed(2);
          var latitudeN = latitude.toFixed(4);
          var longitudeN = longitude.toFixed(4);
          var solar_latN = solar_lat.toFixed(4);
          var solar_lonN = solar_lon.toFixed(4);

          $("#latitudeN").text("Latitude: " + latitudeN),
            $("#longitudeN").text("Longitude: " + longitudeN),
            $("#altitude").text("Altitude: " + altitudeN + " KM"),
            $("#velocity").text("Velocity: " + velocityN + " KPH");
          $("#solar_latN").text("Solar Latitude: " + solar_latN);
          $("#solar_lonN").text("Solar Longitude: " + solar_lonN);
          $("#visibility").text("Visibility: " + visibility);

          mymap = L.map("mapId").setView([latitudeN, longitudeN], 4);

          var issIcon = L.icon({
            iconUrl: "images/iss2.png",

            iconSize: [35, 44], // size of the icon

          });

          L.tileLayer(
            "https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",
            {
              attribution:
                'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
              maxZoom: 14,
              id: "mapbox.streets",
              accessToken:
                "pk.eyJ1IjoicG1hY2s5OSIsImEiOiJjam1zNXh4c2owMGc5M3dwN2ZjeWloc2t5In0.OJ_GGAfAJgMK0OCnN2NbhA"
            }
          ).addTo(mymap);

          L.marker([latitudeN, longitudeN], { icon: issIcon }).addTo(mymap);

        });
      setTimeout(moveIss, 9000);

    }

    // moveIss();


    //Below is the ISS Pass function
    var time = 0;
    var duration = 0;
    var whereStart = [];
    var whereEnd = [];
    var howHigh = 0;
    var maxHigh = 0;
    var startEl = 0;
    var maxEl = 0;
    var passcount = 0;
    var userInput = 0;
    var cityState = 0;
    var apiKeyMapquest = 0;
    var caption = [];

    $("#button-addon1").on("click", function (event) {

      event.preventDefault();
      //$("tbody").empty(" ");

      // var apiKeyMapquest = "VhIG9vrD4t2JMvh5f9k61v8rcGERpvxV";
      var apiKeyMapquest = "ua7RUmNymQq5oRMabONKpUlrpGpV3M6s";
      var userInput = $("input").val();
      var cityState = userInput.trim();
      console.log(cityState);

      var queryUrl =
        "https://www.mapquestapi.com/geocoding/v1/address?key=" +
        apiKeyMapquest +
        "&location=" +
        cityState;
      console.log(queryUrl);

      $.ajax({
        url: queryUrl,
        method: "GET"
      }).then(function (response) {
        var results = response.results;
        console.log(results);

        var lat = results[0].locations[0].displayLatLng.lat;
        var lon = results[0].locations[0].displayLatLng.lng;

        var queryURL = "https://www.n2yo.com/rest/v1/satellite/visualpasses/25544/" + lat + "/" + lon + "/0/2/300/&apiKey=LDUFJ6-J5J7F4-DCMYRA-3WB7"

        console.log(queryURL);


        // Performing our AJAX GET request
        $.ajax({
          url: queryURL,
          method: "GET"
        })
          // After the data comes back from the API
          .then(function (response) {
            console.log(response);

            var passesCount = response.info.passescount;
            if (passesCount == 0) {
              var newRow = $("<tr>").append(
                $("<td>").text("There are no visible passes in the next 10 days"),

              );

              $("tbody").append(newRow);

            } else {
              // Storing an array of results in the results variable
              for (var i = 0; i < response.passes.length; i++) {
                var time = response.passes[i].startUTC;


                var dateString = moment.unix(time).format('LLLL');
                console.log(dateString);

                var duration = response.passes[i].duration;
                console.log("Duration= " + duration + " seconds");

                var whereStart = response.passes[i].startAzCompass
                console.log("ISS appears from the " + whereStart);

                var howHigh = response.passes[i].startEl
                console.log("Starting Elevation = " + howHigh);

                var maxHigh = response.passes[i].maxEl
                console.log("Maximum Elevation = " + maxHigh);

                var whereEnd = response.passes[i].endAzCompass
                console.log("ISS disappears to the " + whereEnd);


                var newRow = $("<tr>").append(

                  $("<td>").text(cityState),
                  $("<td>").text(dateString),
                  $("<td>").text(duration),
                  $("<td>").text(whereStart),
                  $("<td>").text(howHigh),
                  $("<td>").text(maxHigh),
                  $("<td>").text(whereEnd)
                );

                $("tbody").prepend(newRow);





              }
            }

          })

      });
    });

    var i = 0;
    var queryURL = "https://images-api.nasa.gov/search?q=iss&media_type=image"

    $.ajax({
        url: queryURL,
        method: "GET"
    })

        .then(function (response) {
            console.log(response);

            function issImages() {

                $("#apod1 img").remove();
                $(".pCaption").html(" ");

                i = Math.floor(Math.random() * 99 + 1);
                console.log(i);

                var apod = response.collection.items[i].links[0].href;
                var image = $("<img>").attr("src", apod).attr("class", "img").attr("class", "img-fluid").attr("alt", "Responsive image").attr("class", "float-right").attr("class", "rounded");
                var caption = response.collection.items[i].data[0].description;


                $("#apod1").append(image);
                $(".pCaption").append(caption);

                setTimeout(issImages, 30000);

            }

            issImages();


        });



  </script>







  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->


  <!-- jQuery -->
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.flexslider.js"></script>
  <script src="js/jquery.inview.js"></script>
  <script src="js/script.js"></script>
  <script src="contactform/contactform.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>

</body>

</html>